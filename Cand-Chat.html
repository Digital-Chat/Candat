<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Canned Tool</title>
<link rel="icon" href=https://us.123rf.com/450wm/desbayy/desbayy1809/desbayy180901438/107685339-ct-initial-letter-with-negative-space-logo-icon-vector-template.jpg>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --accent1:#4ea8ff;
  --accent2:#7c3aed;
  --warn:#FFD700;
  --footer-from:#251A40;
  --footer-to:#0B3559;
  --sidebar-w:300px;
  --splash-duration:1000ms;
}
[data-theme="light"]{
  --bg1:#f5f8fb;
  --bg2:#eef3fb;
  --card:#ffffff;
  --muted:#334155;
  --text:#0f1724;
}
[data-theme="dark"]{
  --bg1:#0b0f14;
  --bg2:#141226;
  --card:#1a1d29;
  --muted:#cbd5e1;
  --text:#e6f0ff;
}
html,body{
  height:100%;margin:0;padding:0;font-family:'Tajawal',sans-serif;direction:rtl;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
  color:var(--muted);-webkit-font-smoothing:antialiased;
}
/* Splash */
.splash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;
background:var(--bg1);transition:opacity .3s ease;}
.splash-box{display:flex;flex-direction:column;align-items:center;gap:12px;}
.splash .gear{font-size:28px;animation:spin 1s linear infinite;}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* Header */
.header-wrap{position:fixed;top:0;left:0;right:0;height:38px;display:flex;align-items:center;z-index:120;
background:linear-gradient(90deg,var(--accent2),var(--accent1));box-shadow:0 6px 20px rgba(0,0,0,.45);}
.marquee{overflow:hidden;white-space:nowrap;width:100%;padding:6px 18px;}
.marquee .text{display:inline-block;white-space:nowrap;font-weight:800;color:var(--warn);font-size:13px;
text-shadow:0 0 10px rgba(255,215,0,.18);animation:moveLeft 14s linear infinite;}
@keyframes moveLeft{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

/* Theme Toggle */
.theme-toggle{position:fixed;top:6px;left:12px;z-index:130;
background:linear-gradient(90deg,var(--accent1),var(--accent2));
border:none;color:white;padding:6px 8px;border-radius:7px;cursor:pointer;font-weight:800;}

/* Layout */
.app{display:flex;flex-direction:row-reverse;gap:20px;
padding:86px 20px 120px 20px;max-width:1400px;margin:0 auto;box-sizing:border-box;}
.sidebar{position:fixed;top:86px;right:20px;width:var(--sidebar-w);
background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
border-radius:12px;padding:14px;box-shadow:0 10px 30px rgba(2,6,23,.6);
border:1px solid rgba(255,255,255,.03);z-index:110;}
.upload-row{display:flex;gap:8px;align-items:center;}
.upload-btn{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;
border:none;cursor:pointer;color:#fff;background:linear-gradient(90deg,var(--accent1),var(--accent2));
font-weight:800;width:100%;}
.search-box{margin-top:12px;display:flex;align-items:center;gap:8px;
background:rgba(255,255,255,.02);padding:8px;border-radius:10px;
border:1px solid rgba(255,255,255,.02);}
.search-box input{flex:1;border:none;outline:none;background:transparent;
color:var(--text);font-size:14px;padding:6px;}
.sheet-list{margin-top:12px;display:flex;flex-direction:column;gap:8px;
max-height:56vh;overflow:auto;padding-right:6px;}
.sheet-item{padding:10px 12px;border-radius:10px;cursor:pointer;font-weight:700;
text-align:right;color:var(--text);border:1px solid rgba(255,255,255,.02);}
.sheet-item.active{background:linear-gradient(90deg,rgba(78,168,255,.12),rgba(124,58,237,.08));}

/* Main content */
.main{flex:1;min-height:60vh;margin-right:calc(var(--sidebar-w) + 60px);
background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
border-radius:12px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,.08);
border:1px solid rgba(255,255,255,.02);}
.main-header{display:flex;justify-content:space-between;align-items:center;gap:10px;}
.main-header h2{margin:0;color:var(--text);font-size:18px;font-weight:800;}
.instructions{font-size:13px;color:rgba(255,255,255,.7);align-self:flex-start;margin-left:8px;}
.grid{margin-top:12px;display:grid;grid-template-columns:repeat(3,1fr);gap:14px;align-items:stretch;}
@media(max-width:980px){.grid{grid-template-columns:repeat(2,1fr)}.main{margin-right:340px}}
@media(max-width:640px){.app{flex-direction:column-reverse;padding-top:120px;}
.grid{grid-template-columns:1fr}.sidebar{position:relative;top:auto;right:auto;width:100%}
.main{margin-right:0}}
.card{border-radius:12px;border:1px solid rgba(255,255,255,.03);display:flex;flex-direction:column;
overflow:hidden;cursor:pointer;min-height:170px;transition:transform .18s,box-shadow .18s,opacity .35s;
background:var(--card);box-shadow:0 8px 18px rgba(0,0,0,.25);opacity:0;transform:translateY(6px);}
.card.visible{opacity:1;transform:translateY(0);}
.card:hover{transform:translateY(-6px);box-shadow:0 18px 30px rgba(0,0,0,.35);}
.card-title{text-align:center;font-weight:800;font-size:15px;color:var(--accent1);
padding:12px 10px;border-bottom:1px dashed rgba(255,255,255,.02);}
.card-content{padding:12px;flex:1;overflow:hidden;display:flex;flex-direction:column;}
.frame p { margin: 2px 0; line-height: 1.3; }
.frame{background:rgba(255,255,255,.02);border-radius:8px;padding:10px;flex:1;
color:var(--text);font-size:13px;line-height:1.45;overflow:hidden;
display:-webkit-box;-webkit-line-clamp:6;-webkit-box-orient:vertical;text-overflow:ellipsis;}
.card-footer{padding:8px 12px;font-size:12px;color:rgba(255,255,255,.65);
border-top:1px solid rgba(255,255,255,.02);}
.empty{text-align:center;padding:28px;color:var(--muted);
background:rgba(255,255,255,.02);border-radius:8px;}
.footer-wrapper{position:fixed;left:0;right:0;bottom:0;z-index:100;}
.footer-bar{height:46px;background:linear-gradient(90deg,var(--footer-from),var(--footer-to));
display:flex;align-items:center;justify-content:center;box-shadow:0 -6px 20px rgba(11,53,89,.45);}
.footer-bar .text{color:#fff;font-weight:800;text-shadow:0 0 8px rgba(255,255,255,.06);font-size:14px;}
</style>
</head>
<!-- ===== Login Overlay & Basic Client Protection (place near top of your HTML) ===== -->
<style>
  /* login overlay styles */
  #loginOverlay {
    position:fixed; inset:0; background:linear-gradient(180deg, rgba(2,6,23,0.95), rgba(11,25,60,0.95));
    z-index:99999; display:flex; align-items:center; justify-content:center; padding:20px;
  }
  /* ====== Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¢Ù…Ù†Ø© Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø­Ù‚Ù„ ====== */
#loginBox {
  box-sizing: border-box;        /* Ù…Ù‡Ù… Ø­ØªÙ‰ padding ÙŠØ­ØªØ³Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹Ø±Ø¶ */
  width: 360px;
  max-width: 94%;
  background: #0f1724;
  border-radius: 12px;
  padding: 22px 20px 18px 20px;  /* Ù…Ø³Ø§Ø­Ø© ÙƒØ§ÙÙŠØ© ÙÙˆÙ‚ Ø§Ù„Ø­Ù‚Ù„ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø§Ø®Ù„ */
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
  color: #fff;
  text-align: center;
  font-family: 'Tajawal', sans-serif;
}

/* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ */
#loginBox h3 {
  margin: 0 0 14px 0;            /* Ù…Ø³Ø§ÙØ© ÙˆØ§Ø¶Ø­Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø­Ù‚Ù„ */
  font-size: 18px;
  color: #FFD700;
  text-shadow:0 0 8px rgba(255,215,0,0.12);
}

/* Ø§Ù„Ø­Ù‚Ù„ Ù†ÙØ³Ù‡ â€” ØªØ®Ù„ØµÙ†Ø§ Ù…Ù† display:flex Ù„Ø£Ù† input Ø¹Ù†ØµØ± Ø¨Ø¯ÙŠÙ„ */
#loginBox input {
  box-sizing: border-box;        /* ÙŠØ¬Ø¹Ù„ height Ùˆ padding Ù…Ø­Ø³ÙˆØ¨ÙŠÙ† Ù…Ø¹Ø§Ù‹ */
  width: 100%;
  height: 44px;
  padding: 0 12px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.15);
  background-color: rgba(255,255,255,0.04);
  color: #fff;
  margin: 0 0 14px 0;            /* Ù„Ø§ ØªØ¶Ø¹ margin-top Ø³Ù„Ø¨ÙŠØ© */
  outline: none;
  font-size: 15px;
  font-family: 'Tajawal', sans-serif;
  direction: ltr;
  text-align: left;
  line-height: 44px;             /* ÙŠØ¶Ù…Ù† Ù…Ø­Ø§Ø°Ø§Ø© Ø±Ø£Ø³ÙŠØ© Ø³Ù„ÙŠÙ…Ø© Ù„Ù„Ù†Øµ */
  caret-color: #4ea8ff;
  transition: border .18s ease, box-shadow .18s ease, background .12s ease;
}

#loginBox input::placeholder { color: rgba(255,255,255,0.65); }

#loginBox input:focus{
  border-color: #4ea8ff;
  box-shadow: 0 0 6px rgba(78,168,255,0.38);
  background-color: rgba(255,255,255,0.07);
}
  /* ====== Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¢Ù…Ù†Ø© Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø­Ù‚Ù„ ====== */
#loginBox {
  box-sizing: border-box;        /* Ù…Ù‡Ù… Ø­ØªÙ‰ padding ÙŠØ­ØªØ³Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹Ø±Ø¶ */
  width: 360px;
  max-width: 94%;
  background: #0f1724;
  border-radius: 12px;
  padding: 22px 20px 18px 20px;  /* Ù…Ø³Ø§Ø­Ø© ÙƒØ§ÙÙŠØ© ÙÙˆÙ‚ Ø§Ù„Ø­Ù‚Ù„ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¯Ø§Ø®Ù„ */
  box-shadow: 0 10px 40px rgba(0,0,0,0.6);
  color: #fff;
  text-align: center;
  font-family: 'Tajawal', sans-serif;
}

/* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ */
#loginBox h3 {
  margin: 0 0 14px 0;            /* Ù…Ø³Ø§ÙØ© ÙˆØ§Ø¶Ø­Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø­Ù‚Ù„ */
  font-size: 18px;
  color: #FFD700;
  text-shadow:0 0 8px rgba(255,215,0,0.12);
}

/* Ø§Ù„Ø­Ù‚Ù„ Ù†ÙØ³Ù‡ â€” ØªØ®Ù„ØµÙ†Ø§ Ù…Ù† display:flex Ù„Ø£Ù† input Ø¹Ù†ØµØ± Ø¨Ø¯ÙŠÙ„ */
#loginBox input {
  box-sizing: border-box;        /* ÙŠØ¬Ø¹Ù„ height Ùˆ padding Ù…Ø­Ø³ÙˆØ¨ÙŠÙ† Ù…Ø¹Ø§Ù‹ */
  width: 100%;
  height: 44px;
  padding: 0 12px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.15);
  background-color: rgba(255,255,255,0.04);
  color: #fff;
  margin: 0 0 14px 0;            /* Ù„Ø§ ØªØ¶Ø¹ margin-top Ø³Ù„Ø¨ÙŠØ© */
  outline: none;
  font-size: 15px;
  font-family: 'Tajawal', sans-serif;
  direction: ltr;
  text-align: left;
  line-height: 44px;             /* ÙŠØ¶Ù…Ù† Ù…Ø­Ø§Ø°Ø§Ø© Ø±Ø£Ø³ÙŠØ© Ø³Ù„ÙŠÙ…Ø© Ù„Ù„Ù†Øµ */
  caret-color: #4ea8ff;
  transition: border .18s ease, box-shadow .18s ease, background .12s ease;
}

#loginBox input::placeholder { color: rgba(255,255,255,0.65); }

#loginBox input:focus{
  border-color: #4ea8ff;
  box-shadow: 0 0 6px rgba(78,168,255,0.38);
  background-color: rgba(255,255,255,0.07);
}
</style>

<div id="loginOverlay" aria-hidden="false">
  <div id="loginBox" role="dialog" aria-modal="true" aria-label="Login">
    <h3>Login â€” Canned Tool</h3>
    <input id="loginPwd" type="password" dir="ltr" placeholder="Enter Password" autocomplete="off" />
    <button id="loginBtn">Login</button>
    <div id="loginMsg"></div>
    <div style="margin-top:12px;font-size:12px;color:rgba(255,255,255,0.6);">Protected By Password</div>
  </div>
</div>

<script>
  // ===== CONFIRM / ADJUST PASSWORD HERE =====
  const FIXED_PASSWORD = 'Chat2025'; // ØºÙŠÙ‘Ø±Ù‡Ø§ Ù„Ùˆ Ø§Ø­ØªØ¬Øª

  // hide the actual app initially (wrap your app in #protectedApp)
  // **Important**: you need to wrap the whole tool markup in <div id="protectedApp"> ... </div>
  // or if your HTML already has a main root, set its id accordingly and remove the overlay when correct.
  document.addEventListener('DOMContentLoaded', () => {
    const overlay = document.getElementById('loginOverlay');
    const btn = document.getElementById('loginBtn');
    const pwd = document.getElementById('loginPwd');
    const msg = document.getElementById('loginMsg');

    // focus
    pwd.focus();

    function unlock() {
      if (pwd.value === FIXED_PASSWORD) {
        // remove overlay and show app
        overlay.style.opacity = '0';
        setTimeout(()=> overlay.style.display = 'none', 220);
        // reveal protected app container if exists
        const protectedEl = document.getElementById('protectedApp');
        if (protectedEl) protectedEl.style.display = 'block';
        // optionally set a flag in sessionStorage so page reload in same session stays unlocked
        sessionStorage.setItem('candat_unlocked', '1');
        msg.textContent = '';
      } else {
        msg.textContent = 'Wrong Password';
        pwd.value = '';
        pwd.focus();
      }
    }

    btn.addEventListener('click', unlock);
    pwd.addEventListener('keydown', (e)=> { if (e.key === 'Enter') unlock(); });

    // if previously unlocked in this tab session â€” skip login
    if (sessionStorage.getItem('candat_unlocked') === '1') {
      overlay.style.display = 'none';
      const protectedEl = document.getElementById('protectedApp');
      if (protectedEl) protectedEl.style.display = 'block';
    }

    // ===== Basic client-side protection (deterrents) =====
    // Disable right-click
    document.addEventListener('contextmenu', (e) => {
      // allow if overlay active (so admin can still inspect if needed), otherwise prevent
      if (!overlay || overlay.style.display === 'none') e.preventDefault();
    });

    // Block common dev-tools shortcuts
    document.addEventListener('keydown', function(e) {
      // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
      if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) || (e.ctrlKey && e.key === 'U')) {
        e.preventDefault();
        e.stopPropagation();
      }
    });

    // Also try to detect when devtools opened (best-effort) and hide overlay (deterrent)
    let devtoolsOpened = false;
    const threshold = 160;
    setInterval(function() {
      const widthThreshold = window.outerWidth - window.innerWidth > threshold;
      const heightThreshold = window.outerHeight - window.innerHeight > threshold;
      if ((widthThreshold || heightThreshold) && !devtoolsOpened) {
        devtoolsOpened = true;
        console.warn('DevTools detected â€” access is discouraged');
      }
    }, 1000);
  });
</script>
<!-- ===== end login overlay ===== -->
<div id="protectedApp" style="display:none;">
<body data-theme="dark">

<!-- Splash Screen -->
<div class="splash" id="splash">
  <div class="splash-box">
    <div class="gear">âš™ï¸</div>
    <div style="font-weight:800;color:var(--text);">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©...</div>
  </div>
</div>

<!-- Header -->
<div class="header-wrap">
  <div class="marquee">
    <span class="text">âš ï¸ Ù…Ø´ Ù…Ø­ØªØ§Ø¬ Ø£Ù‚ÙˆÙ„Ùƒ Ø¥Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ø£ÙŠ ÙƒØ§Ù†Ø¯ Ù‡Ùˆ Ø¹Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆÙ„Ø§Ø²Ù… Ø¯Ø§ÙŠÙ…Ù‹Ø§ ØªØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ÙˆÙŠÙƒÙŠ âš ï¸</span>
  </div>
</div>

<!-- Theme Toggle -->
<button class="theme-toggle" id="themeToggle">ğŸŒ™</button>

<!-- Layout Wrapper -->
<div class="app">

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="upload-row">
      <button class="upload-btn" id="uploadBtn">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Excel</button>
      <input type="file" id="fileInput" accept=".xlsx" style="display:none">
    </div>
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ ÙƒÙ„ Ø§Ù„Ø´ÙŠØªØ§Øª...">
    </div>
    <div class="sheet-list" id="sheetList"></div>
  </div>

  <!-- Main Content -->
  <div class="main">
    <div class="main-header">
      <h2 id="sheetTitle">ğŸ“‹ Ø§Ø®ØªØ± ØµÙØ­Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h2>
      <span class="instructions">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ø±Ø¨Ø¹ Ù„Ù†Ø³Ø® Ø§Ù„Ù€ Content ÙÙ‚Ø·</span>
    </div>
    <div class="grid" id="cardsGrid">
      <div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© ğŸ”</div>
    </div>
  </div>

</div>

<!-- Footer -->
<div class="footer-wrapper">
  <div class="footer-bar">
    <div class="text">Designed and Developed By Geek @2025</div>
  </div>
</div>

<!-- Click sound Base64 -->
<audio id="clickSound">
  <source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA..."
          type="audio/mp3">
</audio>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const splash = document.getElementById("splash");
  const sheetList = document.getElementById("sheetList");
  const cardsGrid = document.getElementById("cardsGrid");
  const fileInput = document.getElementById("fileInput");
  const uploadBtn = document.getElementById("uploadBtn");
  const searchInput = document.getElementById("searchInput");
  const clickSound = document.getElementById("clickSound");
  const themeToggle = document.getElementById("themeToggle");
  const sheetTitle = document.getElementById("sheetTitle");

  let workbookData = {};
  let currentSheet = null;

  // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  setTimeout(() => splash.style.opacity = "0", 800);
  setTimeout(() => splash.style.display = "none", 1200);

  // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ…
  themeToggle.addEventListener("click", () => {
    const current = document.body.getAttribute("data-theme");
    const next = current === "dark" ? "light" : "dark";
    document.body.setAttribute("data-theme", next);
    themeToggle.textContent = next === "dark" ? "ğŸŒ™" : "â˜€ï¸";
  });

  // ØªØ­Ù…ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯ (Ù„Ù€ GitHub Pages)
  fetch('candat_data.xlsx')
    .then(resp => {
      if (!resp.ok) throw new Error("File not found");
      return resp.arrayBuffer();
    })
    .then(buffer => {
      const wb = XLSX.read(buffer, { type: "array" });
      handleWorkbook(wb);
    })
    .catch(() => console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù - ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§"));

  // Ø±ÙØ¹ ÙŠØ¯ÙˆÙŠ
  uploadBtn.addEventListener("click", () => fileInput.click());
  fileInput.addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = evt => {
      const data = new Uint8Array(evt.target.result);
      const wb = XLSX.read(data, { type: "array" });
      handleWorkbook(wb);
    };
    reader.readAsArrayBuffer(file);
  });

  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù Excel
  function handleWorkbook(wb) {
    workbookData = {};
    wb.SheetNames.forEach(name => {
      const ws = wb.Sheets[name];
      const rows = XLSX.utils.sheet_to_json(ws, { header: 1 });
      const items = [];
      // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ (Name / Content)
      for (let i = 1; i < rows.length; i++) {
        if (rows[i][0] && rows[i][1]) {
          items.push({ name: rows[i][0], content: rows[i][1], sheet: name });
        }
      }
      workbookData[name] = items;
    });
    renderSheetList(wb.SheetNames);
    if (wb.SheetNames.length) showSheet(wb.SheetNames[0]);
  }

  // Ø¹Ø±Ø¶ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø´ÙŠØªØ§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
  function renderSheetList(names) {
    sheetList.innerHTML = "";
    names.forEach(name => {
      const btn = document.createElement("div");
      btn.className = "sheet-item";
      btn.textContent = name;
      btn.addEventListener("click", () => showSheet(name));
      sheetList.appendChild(btn);
    });
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙŠØª Ø§Ù„Ù…Ø­Ø¯Ø¯
  function showSheet(name) {
    currentSheet = name;
    document.querySelectorAll(".sheet-item").forEach(el => el.classList.remove("active"));
    [...sheetList.children].find(el => el.textContent === name)?.classList.add("active");
    sheetTitle.textContent = `ğŸ“„ Ø´ÙŠØª: ${name}`;
    renderCards(workbookData[name]);
  }

  // Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ±ÙˆØª
  function renderCards(items) {
    cardsGrid.innerHTML = "";
    if (!items || !items.length) {
      cardsGrid.innerHTML = '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© ğŸ”</div>';
      return;
    }
    items.forEach((item, index) => {
      const card = document.createElement("div");
      card.className = "card";

      const hasNewlines = (item.content.match(/\n/g) || []).length > 0;
      const formatted = hasNewlines 
        ? item.content.replace(/\n/g, "<p>&nbsp;</p>")
        : item.content;

      card.innerHTML = `
        <div class="card-title">${item.name}</div>
        <div class="card-content">
          <div class="frame">${formatted}</div>
        </div>
        <div class="card-footer">ğŸ“„ Ù…Ù† Ø´ÙŠØª: ${item.sheet}</div>`;

      card.addEventListener("click", () => {
        copyText(hasNewlines ? formatted : item.content);
        playClick();
      });

      cardsGrid.appendChild(card);
      setTimeout(() => card.classList.add("visible"), 100 + index * 40);
    });
  }

  // Ø§Ù„Ù†Ø³Ø®
  function copyText(text) {
    const temp = document.createElement("textarea");
    temp.value = text;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
  }

  // Ø§Ù„ØµÙˆØª
  function playClick() {
    clickSound.currentTime = 0;
    clickSound.play();
  }

// Ø¨Ø­Ø« Ø¹Ø§Ù„Ù…ÙŠ Ø¹Ø¨Ø± ÙƒÙ„ Ø§Ù„Ø´ÙŠØªØ§Øª â€” ÙŠØ¹Ø±Ø¶ Ø§Ø³Ù… Ø§Ù„Ø´ÙŠØª ØªØ­Øª ÙƒÙ„ ÙƒØ§Ø±Øª
searchInput.addEventListener("input", () => {
  const q = (searchInput.value || '').trim().toLowerCase();

  // Ù„Ùˆ Ø§Ù„Ø­Ù‚Ù„ ÙØ§Ø¶ÙŠ: Ø¹Ø±Ø¶ Ø§Ù„Ø´ÙŠØª Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø£Ùˆ Ø±Ø³Ø§Ù„Ø© Ù„Ùˆ Ù…ÙÙŠØ´ Ø´ÙŠØª Ù…Ø­Ø¯Ø¯)
  if (!q) {
    if (currentSheet) {
      renderCards(workbookData[currentSheet] || []);
      sheetTitle.textContent = `ğŸ“„ Ø´ÙŠØª: ${currentSheet}`;
    } else {
      cardsGrid.innerHTML = '<div class="empty">Ø§Ø®ØªØ± Ø´ÙŠØª Ø£Ùˆ Ø§Ø±ÙØ¹ Ù…Ù„ÙÙ‹Ø§ Ù„Ù„Ø¨Ø¯Ø¡</div>';
      sheetTitle.textContent = `ğŸ“‹ Ø§Ø®ØªØ± ØµÙØ­Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©`;
    }
    return;
  }

  // Ù†Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ù† ÙƒÙ„ Ø§Ù„Ø´ÙŠØªØ§Øª
  const results = [];
  Object.keys(workbookData).forEach(sheetName => {
    (workbookData[sheetName] || []).forEach(item => {
      const hay = ((item.name || '') + ' ' + (item.content || '')).toString().toLowerCase();
      if (hay.includes(q)) {
        const copy = Object.assign({}, item);
        copy.sheet = sheetName; // Ø¶Ù…Ù† Ø£Ù† Ø®Ø§ØµÙŠØ© sheet Ù…ÙˆØ¬ÙˆØ¯Ø©
        results.push(copy);
      }
    });
  });

  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
  if (!results.length) {
    cardsGrid.innerHTML = '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© ğŸ”</div>';
    sheetTitle.textContent = `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: "${searchInput.value.trim()}"`;
  } else {
    // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø­Ø«
    sheetTitle.textContent = `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: "${searchInput.value.trim()}" (${results.length})`;
    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ (ØªØ£ÙƒØ¯ Ø£Ù† renderCards ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¹Ù†Ø§ØµØ± ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ .sheet)
    renderCards(results);
  }
});
});
</script>
</body>
</html>
</div>
